name: Cypress Tests
on: [push]
jobs:
  cypress:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Cache multiple paths
        uses: actions/cache@v2
        with:
          path: |
            ~/cache
            ~/.cache
            !~/cache/exclude
            ~/.cache/Cypress
            **/node_modules
          key: ${{ runner.os }}-${{ hashFiles('**/lockfiles') }}
      - name: Start localhost and run tests
        uses: cypress-io/github-action@v2
        with:
          start: yarn client
          wait-on: 'http://localhost:3000'
          config: pageLoadTimeout=200000,baseUrl=http://localhost:3000
          browser: chrome
          env: NODE_ENV=dev
